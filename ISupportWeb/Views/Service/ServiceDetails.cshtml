@inject Microsoft.Extensions.Configuration.IConfiguration Configuration
@model ISupportWeb.Models.BLL.serviceBLL

@{
    ViewBag.Title = "Service Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@* <div class="hero-slider service-detail-one ">
    <div class="single-slide" style="background-image: url('@Url.Content("~/assets/service-detail.png")')" ; background-size:cover; height:200px;">
    </div>
</div> *@
<div>
    <img src="~/assets/Service Detail-1.png" />
</div>

<div class="main-content-wrap section-ptb product-details-page">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6">
                <div class="product-details-images">
                    <div class="product_details_container">
                        <div class="product_big_images-top">
                            <div class="portfolio-full-image tab-content">

                                @if (Model.Image != "")
                                {
                                    <div role="tabpanel" class="tab-pane active product-image-position  prod-detail" id="">
                                        <a class="pop">
                                            <img src="@Configuration["ImageBaseUrl"].ToString()@Model.Image" style="width:60%">
                                        </a>
                                    </div>
                                }
                                else
                                {
                                    <div role="tabpanel" class="tab-pane active product-image-position  prod-detail" id="">
                                        <a class="pop">
                                            <img src="~/Content/assets/images/NA.png" alt="#">
                                        </a>
                                    </div>
                                }
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 px-0 px-md-3">
                <div class="product_details_info">

                    <h2 class="m-0">@ViewBag.ServiceDetails.Name</h2>
                    @if (ViewBag.ServiceDetails.DiscountedPrice == null || ViewBag.ServiceDetails.DiscountedPrice == 0)
                    {
                        <ul class="pro_dtl_prize">
                            <li><span class="currency-text mx-0"></span><span class=" mx-0"> @ViewBag.ServiceDetails.Price</span></li>
                        </ul>
                    }
                    else
                    {
                        <ul class="pro_dtl_prize">
                            <li class="old_prize"><span class="currency-text mx-0"></span><span class="mx-0"> @ViewBag.ServiceDetails.Price</span></li>
                            <li><span class="currency-text mx-0"></span><span class="mx-0"> @ViewBag.ServiceDetails.DiscountedPrice</span></li>
                        </ul>
                    }
                    @*}*@
                    <div class="product-quantity-action">
                        <div class="prodict-statas"><span>Quantity :</span></div>
                        <div class="product-quantity">
                            @*                         <form action="#">
                            <div class="product-quantity">
                            <div class="cart-plus-minus">
                            <input id="product-quantity" value="1" type="number">
                            </div>
                            </div>
                            </form> *@
                            <form action="#">
                                <div class="product-quantity">
                                    <div class="cart-plus-minus">
                                        <input id="product-quantity" value="1" type="number" min="1">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="form-group col-md-12" style="padding-left:0px;padding-top:10px;">
                        <label><span>Customize Description :</span></label>
                        <textarea id="ProNote" class="form-control proN " name="ProductNote " placeholder="Notes, e.g. Please put suitable time." rows="3" required=""></textarea>
                    </div>
                    <ul class="pro_dtl_btn">
                        <li><button class="buy_now_btn addItemLS btnalert" onclick="cartclick();">Add to Cart</button></li>
                        <li><a href="#" onclick="wishlistclick(); "><i class="ion-heart"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="product-details-tab mt-60">
                    <ul role="tablist" class="mb-50 nav">
                        <li class="active" role="presentation">
                            <a data-toggle="tab" role="tab" href="#description" class="active">Description</a>
                        </li>
                        @* <li role="presentation">
                        <a data-toggle="tab" role="tab" href="#reviews">Reviews</a>
                        </li>*@
                    </ul>
                </div>
            </div>
            <div class="col-12">
                <div class="product_details_tab_content tab-content">
                    <div class="product_tab_content tab-pane active" id="description" role="tabpanel">
                        <div class="product_description_wrap">
                            @Html.Raw(ViewBag.ServiceDetails.Description)

                        </div>
                    </div>
                    <div class="product_tab_content tab-pane" id="reviews" role="tabpanel">
                        <div class="row">
                            <div class="col-lg-12">
                                <!-- blog-details-wrapper -->

                                <div class="col-lg-7">
                                    <div class="comments-reply-area">
                                        <h5 class="comment-reply-title mb-30">Leave a Reply</h5>
                                        <div class="comment-form-area">
                                            <div class="comment-input">
                                                <div class="row">

                                                    <div class="col-lg-12">
                                                        <p class="comment-form">
                                                            <input id="Name" type="text" required="required" name="Name" placeholder="Name *">
                                                        </p>
                                                    </div>
                                                    @*<div class="col-lg-6">
                                                    <p class="comment-form">
                                                    <input id="Email" type="email" required="required" name="email" placeholder="Email">
                                                    </p>
                                                    </div>*@

                                                    <div class="col-lg-12 form-group">
                                                        <p class="comment-form-comment">
                                                            <textarea id="Description" class="comment-notes" required="required" placeholder="Comment *"></textarea>
                                                        </p>
                                                    </div>
                                                    <div class="col-lg-12 d-flex">

                                                        <h4 class="pl-2">Rate us now  </h4>

                                                        <fieldset class="rating text-center">
                                                            <input type="radio" id="star5" name="rating" value="5" />
                                                            <label class="full" for="star5" title="Awesome - 5 stars"></label>
                                                            <input type="radio" id="star4half" name="rating" value="4.5" />
                                                            <label class="half" for="star4half" title="Pretty good - 4.5 stars"></label>
                                                            <input type="radio" id="star4" name="rating" value="4" />
                                                            <label class="full" for="star4" title="Pretty good - 4 stars"></label>
                                                            <input type="radio" id="star3half" name="rating" value="3.5" />
                                                            <label class="half" for="star3half" title="Meh - 3.5 stars"></label>
                                                            <input type="radio" id="star3" name="rating" value="3" />
                                                            <label class="full" for="star3" title="Meh - 3 stars"></label>
                                                            <input type="radio" id="star2half" name="rating" value="2.5" />
                                                            <label class="half" for="star2half" title="Kinda bad - 2.5 stars"></label>
                                                            <input type="radio" id="star2" name="rating" value="2" />
                                                            <label class="full" for="star2" title="Kinda bad - 2 stars"></label>
                                                            <input type="radio" id="star1half" name="rating" value="1.5" />
                                                            <label class="half" for="star1half" title="Meh - 1.5 stars"></label>
                                                            <input type="radio" id="star1" name="rating" value="1" />
                                                            <label class="full" for="star1" title="Sucks big time - 1 star"></label>
                                                            <input type="radio" id="starhalf" name="rating" value="0.5" />
                                                            <label class="half" for="starhalf" title="Sucks big time - 0.5 stars"></label>
                                                            <input type="radio" class="reset-option" name="rating" value="reset" />
                                                        </fieldset>
                                                    </div>

                                                    <div class="col-lg-12">
                                                        <div class="comment-form-submit">
                                                            <button class="comment-submit" onclick="submitReview(); return false;">SUBMIT</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--// blog-details-wrapper -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal  fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title border-0"></h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <img src="" class="imagepreview">
            </div>
        </div>
    </div>
</div>
<script>
    debugger
    var input = document.getElementById("product-quantity");
    input.addEventListener("change", function () {
        if (input.value < 1) {
            input.value = 1;
        }
    });
</script>
<script>

    var qty = 1;
    $('#product-quantity').on('change', function () {
        qty = this.value;
    });
    function cartclick() {
        var pnote = $('#ProNote').val();
        if (pnote != "") {

            if (@Model.DiscountedPrice == 0 || @Model.DiscountedPrice == null) {
                addtocart(@Model.ItemID, @Model.ServiceID, '@Model.Name', '@Model.Image', @Model.Price, @Model.DiscountedPrice, 'Service', qty, pnote);
                toast('Service Added to Cart', 1);
            }
            else {
                addtocart(@Model.ItemID, @Model.ServiceID, '@Model.Name', '@Model.Image', @Model.Price, @Model.DiscountedPrice, 'Service', qty, pnote);
                toast('Service Added to Cart', 1);
            }


        }
        else {
            toast('Kindly Add Customise Description', 2);
        }
    }
    function wishlistclick() {
        if ($('#double').is(':checked')) {
            addtoWishlist(@Model.ItemID, @Model.ServiceID, '@Model.Name', '@Model.Image', @Model.Price, @Model.DiscountedPrice, 'Service', qty);
            toast('Item Added to wishlist', 1);
        }
        else {
            if (@Model.DiscountedPrice == 0 || @Model.DiscountedPrice == null) {
                addtoWishlist(@Model.ItemID, @Model.ServiceID, '@Model.Name', '@Model.Image', @Model.Price, @Model.DiscountedPrice, 'Service', qty);
                toast('Item Added to wishlist', 1);
            }
            else {
                addtoWishlist(@Model.ItemID, @Model.ServiceID, '@Model.Name', '@Model.Image', @Model.Price, @Model.DiscountedPrice, 'Service', qty);
                toast('Item Added to wishlist', 1);
            }
        }
    }
    function GotoCartPage() {
        window.location.href = '/order/cart/';
    }
    $(function () {
        $('.pop').on('click', function () {
            $('.imagepreview').attr('src', $(this).find('img').attr('src'));
            $('#imagemodal').modal('show');
        });
    });
    function submitReview() {
        var sim = $("input[type='radio']:checked").val();
        var review = new Object();
        review.Name = $('#Name').val();
        review.Email = "";
        review.Contact = 1;
        review.Description = $('#Description').val();
        review.StatusID = 1;
        review.Stars = sim == undefined ? 0 : sim;
        review.ItemID = getParameterByName('ItemID');
        var reviewData = JSON.stringify({ 'data': review });
        if (validate()) {
            $.ajax({
                type: "POST",
                url: '/Product/PostProductReview',
                data: reviewData,
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data.data > 0) {
                        toast("Thankyou for your comments", 1);
                        window.location.reload();
                    }
                    else {

                    }
                },
                error: function (xhr, textStatus, errorThrown) {

                }
            });
        }
    }
    function validate() {
        var flag = true;
        if ($("#Name").val() == '' || $("#Description").val() == '' || $("input[type='radio']:checked").val() == undefined) {
            toast("Necessary field are required for review", 2);
            flag = false;
        }
        return flag;
    }
    function getParameterByName(name) {
        var regexS = "[\\?&]" + name + "=([^&#]*)",
            regex = new RegExp(regexS),
            results = regex.exec(window.location.search);
        if (results == null) {
            return "";
        } else {
            return decodeURIComponent(results[1].replace(/\+/g, " "));
        }
    }
</script>